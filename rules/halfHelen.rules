service cloud.firestore {
    match/databases/{database}/documents {

        match /users/{user} {
            allow read, write: if false;
        }
        
        match /roles/{user} {
            allow read, write: if false;
        }

        match /district/{district} {
            allow read, write: if false;
        }
        
        match /school/{school} {
            allow read, write: if false;
        }

        match /screening/{screening} {
            allow read, write: if false;
        }

        match /screening_type/{screening_type} {
            allow read, write: if false;
        }

        match /student/{student} {
            allow read, write: if false;
        }
    }

    //helper functions

    function isSignedIn() {
        return request.auth != null;
    }

    function getRoles() {
        return get(/databases/$(database)/documents/roles/$(request.auth.uid)).data;
    }

    function hasRole(role) {
        return isSignedIn() && getRoles()[role] == true;
    }

    function hasAnyRole(roles) {
        return isSignedIn() && getRoles().keys().hasAny(roles);
    }

}